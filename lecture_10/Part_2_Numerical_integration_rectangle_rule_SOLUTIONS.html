
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>The rectangle rule - SOLVED &#8212; M24568 and M20741 Intro to CompSMAP</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="The Trapezium rule" href="Part_3_Numerical_Integration_trapezium_rule.html" />
    <link rel="prev" title="The rectangle rule" href="Part_2_Numerical_Integration_rectangle_rule.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">M24568 and M20741 Intro to CompSMAP</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../README.html">
                    Welcome to Computational Mathematics and Introduction to Computational Physics!
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lecture_1/overview.html">
   Lecture 1: Introduction
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_1/Introduction.html">
     A quick look at the Colab/Jupyter interface
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_1/Python_types.html">
     Getting started - Python objects, basic types, and variables
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_1/Python_types_interactive.html">
     INTERACTIVE: Checking object types in Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_1/Python_types_interactive_SOLVED.html">
     INTERACTIVE: Checking object types in Python - SOLVED
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_1/Operators_summary.html">
     Python Main Operators
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_1/Arithmetic_exercises.html">
     Arithmetic Operators - Interactive exercises
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_1/Arithmetic_exercises_SOLVED.html">
     Arithmetic Operators - Interactive exercises - SOLVED
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_1/Operations_mixing_types.html">
     Operations with different types
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_1/Variables.html">
     Variables - an interactive introduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_1/Variables_SOLVED.html">
     Variables - an interactive introduction - SOLVED
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_1/Variable_swap.html">
     Swapping Variables
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_1/Comparison_operators.html">
     Comparison operators - interactively introduced
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_1/String_type.html">
     The string type - interactive
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_1/String_type_SOLVED.html">
     The string type - interactive - SOLVED
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_1/Type_conversion.html">
     Type Conversion - A quick interactive intro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_1/Type_conversion_SOLVED.html">
     Type Conversion - A quick interactive intro - SOLVED
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_1/Errors.html">
     Errors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_1/Summary.html">
     Summary
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_1/Summary_exercises.html">
     Summary exercises
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_1/Summary_exercises_SOLVED.html">
     Summary exercises - SOLVED
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lecture_2/overview.html">
   Lecture 2: Functions, Logic and Conditionals
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_2/1_Functions_overview.html">
     Functions - An overview
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_2/2_Using_functions.html">
     Using (or “calling”) a function - Interactive
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_2/2_Using_functions_SOLVED.html">
     Using (or “calling”) a function - Interactive - SOLVED
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_2/3_Writing_Functions.html">
     How to write your own function
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_2/4_Writing_Functions_Exercises.html">
     Writing Functions - Exercises
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_2/4_Writing_Functions_Exercises_SOLVED.html">
     Writing Functions - Exercises - SOLVED
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_2/5_Writing_functions_exercises_2.html">
     Writing functions with multiple inputs and outputs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_2/5_Writing_functions_exercises_2_SOLVED.html">
     Writing functions with multiple inputs and outputs - SOLVED
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_2/6_Importing_functions.html">
     Importing a function
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_2/6a_Function_Failures.html">
     The most common reasons people use functions wrong and don’t pass coursework questions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_2/7_Logical_operators.html">
     Logical operators
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_2/8_Logical_Exercises.html">
     Logical Operators - Exercises
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_2/8_Logical_Exercises_SOLVED.html">
     Logical Operators - Exercises - SOLVED
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_2/9_Conditionals.html">
     Conditional statements
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_2/10_Conditional_Exercises.html">
     Conditionals - Exercises
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_2/10_Conditional_Exercises_SOLVED.html">
     Conditionals - Exercises - SOLVED
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_2/11_Summary.html">
     Summary
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_2/12_Summary_Exercises.html">
     End of class exercises
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_2/12_Summary_Exercises_SOLVED.html">
     End of class exercises - SOLVED
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lecture_3/overview.html">
   Lecture 3: Loops and lists
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_3/Part_1_loops_intro.html">
     Loops and lists: an overview
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_3/Part_2_Writing_a_for_loop_interactive.html">
     Using a for loop: interactive
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_3/Part_2_Writing%20a%20for%20loop_Interactive_SOLUTION.html">
     Using a for loop: interactive - SOLVED
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_3/Part_3_for_loop_exercises.html">
     For loops: exercises
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_3/Part_3_for_loop_exercises_SOLUTION.html">
     For loops: exercises - SOLVED
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_3/Part_4_while_loops.html">
     The while loop: interactive
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_3/Part_4_while_loops_SOLUTION.html">
     The while loop: interactive - SOLVED
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_3/Part_5_sums.html">
     Writing sums as functions: INTERACTIVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_3/Part_5_sums_SOLUTION.html">
     Writing sums as functions: INTERACTIVE - SOLVED
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_3/Part_6_lists.html">
     Lists (interactive)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_3/Part_6_lists_SOLUTION.html">
     Lists (interactive) - SOLVED
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_3/Part_7_list_exercises.html">
     Lists: exercises
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_3/Part_7_list_exercises_SOLUTION.html">
     Lists: exercises - SOLVED
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_3/Part_8_indices.html">
     Indices and ordering: INTERACTIVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_3/Part_8_indices_SOLUTION.html">
     Indices and ordering: INTERACTIVE - SOLVED
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_3/Part_9_removing_from_list.html">
     Lists: some other list operations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_3/Part_9_removing_from_list_SOLUTION.html">
     Lists: some other list operations - SOLVED
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_3/Part_10_summary_exercises.html">
     Summary exercises
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_3/Part_10_summary_exercises_SOLUTION.html">
     Summary exercises - SOLVED
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lecture_4/overview.html">
   Lecture 4: Data types
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_4/Part1_DataTypes_Introduction.html">
     The File object: A brief introduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_4/Part1_DataTypes_Introduction_SOLVED.html">
     The File object: A brief introduction - SOLVED
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_4/Part2_DataTypes_tuple_set_dictionary.html">
     Introducing tuples, sets and dictionaries
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_4/Part2_DataTypes_tuple_set_dictionary_SOLVED.html">
     Introducing tuples, sets and dictionaries - SOLVED
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_4/Part3_DataTypes_further_exercises.html">
     Further exercises on sets, tuples and dictionaries
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_4/Part3_DataTypes_further_exercises_SOLVED.html">
     Further exercises on sets, tuples and dictionaries - SOLVED
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_4/Part4_DataTypes_challenge_exercises.html">
     Challenge exercises
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_4/Part4_DataTypes_challenge_exercises_SOLVED.html">
     Challenge exercises - SOLVED
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_4/Part5_DataTypes_13_14.html">
     Additional resources
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lecture_5/overview.html">
   Lecture 5: Numpy
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_5/Part01_numpy_introduction.html">
     Introduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_5/Part01_numpy_introduction_solution.html">
     Introduction - SOLVED
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_5/Part02_numpy_basic_arrays.html">
     How to create basic arrays
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_5/Part02_numpy_basic_arrays_solutions.html">
     How to create basic arrays - SOLVED
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_5/Part03_numpy_array_operations.html">
     Basic array operations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_5/Part03_numpy_array_operations_solutions.html">
     Basic array operations - SOLVED
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_5/Part04_numpy_indexing_slicing.html">
     Indexing and Slicing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_5/Part04_numpy_indexing_slicing_solution.html">
     Indexing and Slicing - SOLVED
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_5/Part05_numpy_iterating.html">
     Iterating over an numpy array
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_5/Part05_numpy_iterating_solutions.html">
     Iterating over an numpy array - SOLVED
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_5/Part06_numpy_sorting_arrays.html">
     Sorting, adding and removing elements from an array
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_5/Part06_numpy_sorting_arrays_solutions.html">
     Sorting, adding and removing elements from an array - SOLVED
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_5/Part07_numpy_broadcasting.html">
     Broadcasting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_5/Part07_numpy_broadcasting_solutions.html">
     Broadcasting - SOLVED
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_5/Part08_numpy_array_axes.html">
     Using a particular axis of an array
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_5/Part08_numpy_array_axes_solutions.html">
     Using particular axis of an array - SOLVED
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_5/Part09_numpy_summary_exercises.html">
     Summary Exercises
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_5/Part09_numpy_summary_exercises_solution.html">
     Summary Exercises - SOLVED
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lecture_6/overview.html">
   Lecture 6: Visualisation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_6/Part01_Introduction_to_Plotting.html">
     Introduction to plotting in matplotlib
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_6/Part01_Introduction_to_Plotting_SOLVED.html">
     Introduction to plotting in matplotlib - SOLVED
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_6/Part02_Interactive_plots.html">
     Adding Interactive Elements: Sliders
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_6/Part02_Interactive_plots_SOLVED.html">
     Adding Interactive Elements: Sliders - SOLVED
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_6/Part03_Challenge_exercises.html">
     Challenge exercises
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_6/Part03_Challenge_exercises_SOLVED.html">
     Challenge exercises - SOLVED
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lecture_7/overview.html">
   Lecture 7: Understanding and fixing problems in python code
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_7/Part_1_Introduction.html">
     Introduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_7/Part_2_Introducing_PDB.html">
     Using PDB to debug code
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_7/Part_3_Syntax_Errors.html">
     Exercise 1: Syntax errors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_7/Part_3_Syntax_Errors-Solutions.html">
     Exercise 1: Syntax errors - SOLVED
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_7/Part_4_Short_Failing_Examples.html">
     Exercise 2 - Short failing examples
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_7/Part_4_Short_Failing_Examples-Solutions.html">
     Exercise 2 - Short failing examples - SOLVED
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_7/Part_5_Variable_Scope.html">
     Exercise 3 - Variable Scope
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_7/Part_5_Variable_Scope-Solutions.html">
     Exercise 3 - Variable Scope - SOLVED
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_7/Part_6_Exercises_4_to_6.html">
     Exercises 4 - 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_7/Part_6_Exercises_4_to_6-Solutions.html">
     Exercises 4 - 6 - SOLVED
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_7/Part_7_Exercises_7_to_9.html">
     Exercises 7 to 9
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_7/Part_7_Exercises_7_to_9-Solution.html">
     Exercises 7 to 9 - SOLVED
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_7/Part_8_Acknowledgements.html">
     Acknowledgements
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lecture_8/overview.html">
   Lecture 8: Data manipulation (with pandas)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_8/Part00_Week_8_into.html">
     Introduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_8/Part00_Week_8_into_solved.html">
     Introduction - SOLVED
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_8/Part01_week8_data_frames.html">
     Part 1: data frames (extra powerful dictionaries)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_8/Part01_week8_data_frames_solutions.html">
     Part 1: data frames (extra powerful dictionaries) - SOLVED
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_8/Part02_week8_viewing_data.html">
     Part 2: viewing data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_8/Part02_week8_viewing_data_solved.html">
     Part 2: viewing data - SOLVED
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_8/Part03_week8_selecting_elements.html">
     Part 3: selecting elements from a data frame
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_8/Part03_week8_selecting_elements_solutions.html">
     Part 3: selecting elements from a data frame - SOLVED
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_8/Part04_week8_more_operations.html">
     Part 4: More operations on DataFrames
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_8/Part04_week8_more_operations_solutions.html">
     Part 4: More operations on DataFrames - SOLVED
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_8/Part05_week8_grouping.html">
     Parts 5 and 6: grouping and visualising data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_8/Part05_week8_grouping_solutions.html">
     Parts 5 and 6: grouping and visualising data - SOLVED
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_8/Part06_week8_importing_files.html">
     Part 7: Importing and exporting files / spreadsheets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_8/Part06_week8_importing_files_solutions.html">
     Part 7: Importing and exporting files / spreadsheets - SOLVED
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_8/Part07_week8_summary_exercises.html">
     Part 8: Summary exercises
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_8/Part07_week8_summary_exercises_solutions.html">
     Part 8: Summary exercises - SOLVED
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lecture_9/overview.html">
   Lecture 9: Root finding
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_9/Part_1_Introduction.html">
     What is root finding and why do it on a computer?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_9/Part_2_Continuous_Functions.html">
     Continuous functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_9/Part_2_Continuous_Functions-SOLVED.html">
     Continuous functions - SOLUTIONS
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_9/Part_3_Bolzanos_Theorem.html">
     Bolzano’s Theorem
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_9/Part_3_Bolzanos_Theorem-SOLVED.html">
     Bolzano’s Theorem - SOLUTIONS
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_9/Part_4_Bisection_Method.html">
     Writing a root finding algorithm using the bisection method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_9/Part_4_Bisection_Method-SOLVED.html">
     Writing a root finding algorithm using the bisection method - SOLUTIONS
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_9/Part_5_Newtons_Method.html">
     Newton’s Method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lecture_9/Part_5_Newtons_Method-SOLVED.html">
     Newton’s Method - SOLUTIONS
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="overview.html">
   Lecture 10: Numerical Integration
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="Part_1_Introduction.html">
     Introduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Part_2_Numerical_Integration_rectangle_rule.html">
     The rectangle rule
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     The rectangle rule - SOLVED
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Part_3_Numerical_Integration_trapezium_rule.html">
     The Trapezium rule
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Part_3_Numerical_integration_trapezium_rule_SOLUTIONS.html">
     Trapezium rule and Simpson’s rule - Solutions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Part_4_Numerical_Integration_Simpson%27s_rule.html">
     Simpson’s rule
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Appendix_code_for_graphs.html">
     APPENDIX
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/icg-gravwaves/M24568_M20741_CompSMAP/main?urlpath=lab/tree/lecture_10/Part_2_Numerical_integration_rectangle_rule_SOLUTIONS.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/icg-gravwaves/M24568_M20741_CompSMAP/blob/main/lecture_10/Part_2_Numerical_integration_rectangle_rule_SOLUTIONS.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
      <li>
        
<button onclick="initThebeSBT()"
  class="headerbtn headerbtn-launch-thebe"
  data-toggle="tooltip"
data-placement="left"
title="Launch Thebe"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="headerbtn__text-container">Live Code</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/icg-gravwaves/M24568_M20741_CompSMAP"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/icg-gravwaves/M24568_M20741_CompSMAP/issues/new?title=Issue%20on%20page%20%2Flecture_10/Part_2_Numerical_integration_rectangle_rule_SOLUTIONS.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/lecture_10/Part_2_Numerical_integration_rectangle_rule_SOLUTIONS.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#guided-exercise-part-2">
   Guided exercise part 2
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#guided-exercise-part-3">
   Guided exercise part 3
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#guided-exercise-part-4">
   Guided exercise part 4
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#guided-exercise-part-5">
   Guided exercise part 5
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#guided-exercise-part-6">
   Guided exercise part 6
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#guided-exercise-part-7">
   Guided exercise part 7
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise">
   Exercise
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   Exercise
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   Exercise
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rectangle-rule-summarized">
   Rectangle rule - summarized
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>The rectangle rule - SOLVED</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#guided-exercise-part-2">
   Guided exercise part 2
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#guided-exercise-part-3">
   Guided exercise part 3
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#guided-exercise-part-4">
   Guided exercise part 4
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#guided-exercise-part-5">
   Guided exercise part 5
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#guided-exercise-part-6">
   Guided exercise part 6
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#guided-exercise-part-7">
   Guided exercise part 7
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise">
   Exercise
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   Exercise
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   Exercise
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rectangle-rule-summarized">
   Rectangle rule - summarized
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="the-rectangle-rule-solved">
<h1>The rectangle rule - SOLVED<a class="headerlink" href="#the-rectangle-rule-solved" title="Permalink to this headline">#</a></h1>
<p>The first step in this process is to place our rectangles. We will begin by deciding where the <em>edges</em> of the rectangles are. To do so we will write a function <code class="docutils literal notranslate"><span class="pre">rectangle_edges</span></code> which takes 3 inputs <code class="docutils literal notranslate"><span class="pre">N</span></code> the number of edges that we want, <code class="docutils literal notranslate"><span class="pre">lower_val</span></code> the value of the smallest edge, <code class="docutils literal notranslate"><span class="pre">upper_val</span></code> the value of the highest edge. In this function you will need to</p>
<ol class="simple">
<li><p>Define an array of <code class="docutils literal notranslate"><span class="pre">N</span></code> linearly spaced x values between <code class="docutils literal notranslate"><span class="pre">lower_val</span></code> and <code class="docutils literal notranslate"><span class="pre">upper_val</span></code>.</p></li>
<li><p>Return that array</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">rectangle_edges</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">lower_val</span><span class="p">,</span> <span class="n">upper_val</span><span class="p">):</span>
    <span class="c1"># COMPLETE THIS FUNCTION AS DESCRIBED</span>
    <span class="n">x_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">lower_val</span><span class="p">,</span> <span class="n">upper_val</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x_values</span>
</pre></div>
</div>
</div>
</div>
<p>To test your function, run the following code.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This should read [0.5, 0.8, 1.1, 1.4, 1.7, 2]&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rectangle_edges</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>This should read [0.5, 0.8, 1.1, 1.4, 1.7, 2]
[0.5 0.8 1.1 1.4 1.7 2. ]
</pre></div>
</div>
</div>
</div>
<section id="guided-exercise-part-2">
<h2>Guided exercise part 2<a class="headerlink" href="#guided-exercise-part-2" title="Permalink to this headline">#</a></h2>
<p>Write a function <code class="docutils literal notranslate"><span class="pre">compute_stepsize</span></code> that computes the gap between the rectangles. <strong>HINT</strong> the rectangles are equally spaced so you only have to compute the gap between the first two points.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_step_size</span><span class="p">(</span><span class="n">rect_edges</span><span class="p">):</span>
    <span class="c1"># COMPLETE CODE</span>
    <span class="k">return</span> <span class="n">rect_edges</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">rect_edges</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">rect_edges</span> <span class="o">=</span> <span class="n">rectangle_edges</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
<span class="n">stepsize</span> <span class="o">=</span> <span class="n">compute_step_size</span><span class="p">(</span><span class="n">rect_edges</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Stepsize should be 0.3&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stepsize is </span><span class="si">{</span><span class="n">stepsize</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Stepsize should be 0.3
Stepsize is 0.30000000000000004
</pre></div>
</div>
</div>
</div>
</section>
<section id="guided-exercise-part-3">
<h2>Guided exercise part 3<a class="headerlink" href="#guided-exercise-part-3" title="Permalink to this headline">#</a></h2>
<p>We now need to identify the midpoint (on the x-axis) of each of the rectangles. Again, let’s describe what is needed:</p>
<ol class="simple">
<li><p>Write a function <code class="docutils literal notranslate"><span class="pre">f_midpoint</span></code>. This function should take 2 input values <code class="docutils literal notranslate"><span class="pre">lower_edge</span></code> and <code class="docutils literal notranslate"><span class="pre">upper_edge</span></code> and return the midpoint. For example if the lower_edge is 0.5 and the upper_edge is 1, the midpoint is 0.75 (which is halfway between 0.5 and 1).</p></li>
<li><p>Use the <code class="docutils literal notranslate"><span class="pre">f_midpoint</span></code> function to find the midpoint of all your rectangles. <em>HINT</em> our example above used 5 rectangles. But 5 rectangles have 6 edges. Therefore if we use N=6 when calling <code class="docutils literal notranslate"><span class="pre">rectangle_edges</span></code> we will expect only 5 rectangles, and so 5 midpoints. You could do this in a for loop, but is it possible to do it using <em>slicing</em> of numpy arrays? (Do whatever you are happiest with, and talk to us if it is unclear.)</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your function f_midpoint here</span>
<span class="k">def</span> <span class="nf">f_midpoints</span><span class="p">(</span><span class="n">lower_edge</span><span class="p">,</span> <span class="n">upper_edge</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">upper_edge</span> <span class="o">+</span> <span class="n">lower_edge</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>

<span class="c1"># Create our set of 5 rectangles from before</span>
<span class="n">rect_edges</span> <span class="o">=</span> <span class="n">rectangle_edges</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
<span class="n">stepsize</span> <span class="o">=</span> <span class="n">compute_step_size</span><span class="p">(</span><span class="n">rect_edges</span><span class="p">)</span>
<span class="c1"># Now write code to compute the midpoints of these rectangles</span>
<span class="c1"># INSERT CODE HERE</span>
<span class="c1">#rect_midpoints = []</span>
<span class="c1">#for i in range(5):</span>
<span class="c1">#    rect_midpoints.append(f_midpoint(rect_edges[i], rect_edges[i+1]))</span>

<span class="n">rect_midpoints</span> <span class="o">=</span> <span class="n">f_midpoints</span><span class="p">(</span><span class="n">rect_edges</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">rect_edges</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The midpoints should be [0.65, 0.95, 1.25, 1.55, 1.85&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rect_midpoints</span><span class="p">)</span> <span class="c1"># Change the variable name if you called it something else</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The midpoints should be [0.65, 0.95, 1.25, 1.55, 1.85
[0.65 0.95 1.25 1.55 1.85]
</pre></div>
</div>
</div>
</div>
</section>
<section id="guided-exercise-part-4">
<h2>Guided exercise part 4<a class="headerlink" href="#guided-exercise-part-4" title="Permalink to this headline">#</a></h2>
<p>Write a function to compute <span class="math notranslate nohighlight">\(e^{-x^2}\)</span>. It should take as input a numpy array of x values, and return an array of <span class="math notranslate nohighlight">\(e^{-x^2}\)</span> for all inputs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_ex2</span><span class="p">(</span><span class="n">x_values</span><span class="p">):</span>
    <span class="c1"># Complete function below</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span> <span class="n">x_values</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>


<span class="n">rect_edges</span> <span class="o">=</span> <span class="n">rectangle_edges</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
<span class="n">stepsize</span> <span class="o">=</span> <span class="n">compute_step_size</span><span class="p">(</span><span class="n">rect_edges</span><span class="p">)</span>
<span class="n">rect_midpoints</span> <span class="o">=</span> <span class="n">f_midpoints</span><span class="p">(</span><span class="n">rect_edges</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">rect_edges</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>

<span class="n">y_values</span> <span class="o">=</span> <span class="n">compute_ex2</span><span class="p">(</span><span class="n">rect_midpoints</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The y_values should be [0.65540625 0.40555451 0.20961139 0.09049144 0.03263076]&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The y_values are </span><span class="si">{</span><span class="n">y_values</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The y_values should be [0.65540625 0.40555451 0.20961139 0.09049144 0.03263076]
The y_values are [0.65540625 0.40555451 0.20961139 0.09049144 0.03263076]
</pre></div>
</div>
</div>
</div>
</section>
<section id="guided-exercise-part-5">
<h2>Guided exercise part 5<a class="headerlink" href="#guided-exercise-part-5" title="Permalink to this headline">#</a></h2>
<p>Now we can make a plot to illustrate this. If all your functions above work, you should just be able to run the code below and produce the plots we used for illustration earlier!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># These 4 values are the things that are specific to this example. If we changed these we could compute any integral in this way</span>
<span class="n">N_rectangles</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">lower_bound</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">upper_bound</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">function</span> <span class="o">=</span> <span class="n">compute_ex2</span>

<span class="n">rect_edges</span> <span class="o">=</span> <span class="n">rectangle_edges</span><span class="p">(</span><span class="n">N_rectangles</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">lower_bound</span><span class="p">,</span> <span class="n">upper_bound</span><span class="p">)</span>
<span class="n">stepsize</span> <span class="o">=</span> <span class="n">compute_step_size</span><span class="p">(</span><span class="n">rect_edges</span><span class="p">)</span>
<span class="n">rect_midpoints</span> <span class="o">=</span> <span class="n">f_midpoints</span><span class="p">(</span><span class="n">rect_edges</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">rect_edges</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
<span class="n">y_values</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">rect_midpoints</span><span class="p">)</span>

<span class="c1"># Plot the red crosses</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rect_midpoints</span><span class="p">,</span> <span class="n">y_values</span><span class="p">,</span> <span class="s1">&#39;rx&#39;</span><span class="p">)</span> <span class="c1"># Plot the line</span>

<span class="c1"># Plot the rectangles, this is a bit more involved</span>
<span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_rectangles</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="n">rect_edges</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">rect_edges</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">rect_edges</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">rect_edges</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">]],</span>
             <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">y_values</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">y_values</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="mi">0</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$e^{-x^2}$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Part_2_Numerical_integration_rectangle_rule_SOLUTIONS_12_0.png" src="../_images/Part_2_Numerical_integration_rectangle_rule_SOLUTIONS_12_0.png" />
</div>
</div>
</section>
<section id="guided-exercise-part-6">
<h2>Guided exercise part 6<a class="headerlink" href="#guided-exercise-part-6" title="Permalink to this headline">#</a></h2>
<p>Now we can compute the integral. To do this we write another function <code class="docutils literal notranslate"><span class="pre">compute_rect_area</span></code>. This function takes as input <code class="docutils literal notranslate"><span class="pre">y_values</span></code> the height of the rectangles and <code class="docutils literal notranslate"><span class="pre">stepsize</span></code> the width of the rectangles. Note the <code class="docutils literal notranslate"><span class="pre">y_values</span></code> should be a numpy array (as it is different for each rectangle), but <code class="docutils literal notranslate"><span class="pre">stepsize</span></code> is just a single value (as all rectangles have the same width). This function should then:</p>
<ol class="simple">
<li><p>Compute the area of each rectangle. Remember area = width * height, so you can quickly compute the area for each rectangle.</p></li>
<li><p>Sum the area of all the rectangles up</p></li>
<li><p>Return the sum of the areas of all the rectangles</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_rect_area</span><span class="p">(</span><span class="n">y_values</span><span class="p">,</span> <span class="n">stepsize</span><span class="p">):</span>
    <span class="c1"># COMPLETE CODE HERE</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y_values</span> <span class="o">*</span> <span class="n">stepsize</span><span class="p">)</span>

<span class="n">rect_edges</span> <span class="o">=</span> <span class="n">rectangle_edges</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
<span class="n">stepsize</span> <span class="o">=</span> <span class="n">compute_step_size</span><span class="p">(</span><span class="n">rect_edges</span><span class="p">)</span>
<span class="n">rect_midpoints</span> <span class="o">=</span> <span class="n">f_midpoints</span><span class="p">(</span><span class="n">rect_edges</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">rect_edges</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
<span class="n">y_values</span> <span class="o">=</span> <span class="n">compute_ex2</span><span class="p">(</span><span class="n">rect_midpoints</span><span class="p">)</span>

<span class="c1"># Now the new bit</span>
<span class="n">integral</span> <span class="o">=</span> <span class="n">compute_rect_area</span><span class="p">(</span><span class="n">y_values</span><span class="p">,</span> <span class="n">stepsize</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The integral should be 0.4181083032593553&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The integral was computed to be </span><span class="si">{</span><span class="n">integral</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The integral should be 0.4181083032593553
The integral was computed to be 0.4181083032593553
</pre></div>
</div>
</div>
</div>
</section>
<section id="guided-exercise-part-7">
<h2>Guided exercise part 7<a class="headerlink" href="#guided-exercise-part-7" title="Permalink to this headline">#</a></h2>
<p>Well done. You’ve just computed the numerical integral of <span class="math notranslate nohighlight">\(e^{-x^2}\)</span>. Now let’s tie all this together so we can more easily compute other integrals, and change the ranges. To do this:</p>
<p>Write a function <code class="docutils literal notranslate"><span class="pre">compute_rectangle_integral(function,</span> <span class="pre">lower_val,</span> <span class="pre">upper_val,</span> <span class="pre">num_rectangles)</span></code>. The function should be the function to compute (ie. compute_ex2) in the example above, <code class="docutils literal notranslate"><span class="pre">lower_val</span></code> is the lower value of integration, <code class="docutils literal notranslate"><span class="pre">upper_val</span></code> is the upper value and <code class="docutils literal notranslate"><span class="pre">num_rectangles</span></code> is the number of rectangles to use.</p>
<p>Within this function you should call all the things you’ve already written, so:</p>
<ol class="simple">
<li><p>Call <code class="docutils literal notranslate"><span class="pre">rectangle_edges</span></code> to get the edges of your rectangles</p></li>
<li><p>Call <code class="docutils literal notranslate"><span class="pre">compute_step_size</span></code> to get the step size.</p></li>
<li><p>Call <code class="docutils literal notranslate"><span class="pre">f_midpoints</span></code> to get the midpoints of your rectangles</p></li>
<li><p>Call <code class="docutils literal notranslate"><span class="pre">function</span></code> to get the y_values (the heights) of your rectangles.</p></li>
<li><p>Call <code class="docutils literal notranslate"><span class="pre">compute_rect_area</span></code> to get the integral.</p></li>
<li><p>Return the integral.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_rectangle_integral</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <span class="n">lower_val</span><span class="p">,</span> <span class="n">upper_val</span><span class="p">,</span> <span class="n">num_rectangles</span><span class="p">):</span>
    <span class="c1"># COMPLETE THIS CODE BELOW</span>
    <span class="n">rect_edges</span> <span class="o">=</span> <span class="n">rectangle_edges</span><span class="p">(</span><span class="n">num_rectangles</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">lower_val</span><span class="p">,</span> <span class="n">upper_val</span><span class="p">)</span>
    <span class="n">stepsize</span> <span class="o">=</span> <span class="n">compute_step_size</span><span class="p">(</span><span class="n">rect_edges</span><span class="p">)</span>
    <span class="n">rect_midpoints</span> <span class="o">=</span> <span class="n">f_midpoints</span><span class="p">(</span><span class="n">rect_edges</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">rect_edges</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="n">y_values</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">rect_midpoints</span><span class="p">)</span>
    <span class="n">integral</span> <span class="o">=</span> <span class="n">compute_rect_area</span><span class="p">(</span><span class="n">y_values</span><span class="p">,</span> <span class="n">stepsize</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">integral</span>


<span class="n">integral</span> <span class="o">=</span> <span class="n">compute_rectangle_integral</span><span class="p">(</span><span class="n">compute_ex2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The integral should be 0.42079376964408877&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The integral is </span><span class="si">{</span><span class="n">integral</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The integral should be 0.42079376964408877
The integral is 0.42079376964408877
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercise">
<h2>Exercise<a class="headerlink" href="#exercise" title="Permalink to this headline">#</a></h2>
<p>Now compute the integral of <span class="math notranslate nohighlight">\(e^{-x^2}\)</span> between <span class="math notranslate nohighlight">\(x=0.5\)</span> and <span class="math notranslate nohighlight">\(x=2\)</span> computed using the “rectangle rule using 100 rectangles.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ADD CODE BELOW</span>
<span class="n">integral</span> <span class="o">=</span> <span class="n">compute_rectangle_integral</span><span class="p">(</span><span class="n">compute_ex2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">integral</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.42079376964408877
</pre></div>
</div>
</div>
</div>
</section>
<section id="id1">
<h2>Exercise<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h2>
<p>Make a plot of the accuracy of the integral of <span class="math notranslate nohighlight">\(e^{-x^2}dx\)</span> between <span class="math notranslate nohighlight">\(x=0.5\)</span> and <span class="math notranslate nohighlight">\(x=2\)</span> computed using the “rectangle rule” as a function of the number of rectangles used.</p>
<p>The x-axis of the plot should be the number of rectangles used in the integral. Vary this between 1 rectangle and 100 rectangles. The y-axis should show the value of the integral.</p>
<p><strong>HINT</strong> You don’t need to write any integration code here, it’s all provided above. Just remove the plotting calls, then call the existing code for many values of the number of rectangles, store the outputs in a list, and then plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ADD CODE BELOW</span>
<span class="n">integral_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">num_rectangles</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">):</span>
    <span class="n">integral_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">compute_rectangle_integral</span><span class="p">(</span><span class="n">compute_ex2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">num_rectangles</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">101</span><span class="p">),</span> <span class="n">integral_list</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Num rectangles&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Integral of $e^{-x^2}$ between 0.5 and 2&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Part_2_Numerical_integration_rectangle_rule_SOLUTIONS_20_0.png" src="../_images/Part_2_Numerical_integration_rectangle_rule_SOLUTIONS_20_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">integral_list</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.3144170807266467, 0.40226990312386074, 0.41308241713298993, 0.4165522085393729, 0.4181083032593553, 0.41894082588235804, 0.41943854615366943, 0.41975988647889984, 0.4199794284472106, 0.420136083977214, 0.4202517871569165, 0.4203396728984657, 0.42040799942935114, 0.42046217137315095, 0.4205058467893739, 0.4205415734959833, 0.4205711703587752, 0.42059596405710226, 0.4206169407248601, 0.4206348457397349, 0.4206502509823336, 0.4206636011465935, 0.42067524624143, 0.42068546479747904, 0.4206944806978831, 0.42070247555968837, 0.42070959796131263, 0.4207159704020785, 0.4207216946092978, 0.42072685562662393, 0.42073152499337935, 0.42073576323876505, 0.42073962185462843, 0.4207431448677929, 0.420746370102209, 0.4207493301989571, 0.4207520534457769, 0.42075456445571785, 0.4207568847254853, 0.4207590330972486, 0.420761026142529, 0.42076287848284183, 0.4207646030587309, 0.4207662113564653, 0.42076771359985243, 0.42076911891317265, 0.42077043546009235, 0.42077167056252907, 0.4207728308026966, 0.42077392211100656, 0.4207749498420215, 0.4207759188402755, 0.4207768334974816, 0.42077769780239327, 0.4207785153843706, 0.42077928955155797, 0.4207800233243956, 0.4207807194651442, 0.42078138050391395, 0.42078200876169225, 0.42078260637075277, 0.42078317529276826, 0.4207837173349381, 0.420784234164351, 0.42078472732083083, 0.42078519822841076, 0.42078564820563563, 0.42078607847479804, 0.4207864901702437, 0.4207868843458698, 0.4207872619818617, 0.4207876239908093, 0.4207879712232073, 0.42078830447247667, 0.42078862447948256, 0.4207889319366677, 0.42078922749179765, 0.4207895117513808, 0.42078978528376815, 0.42079004862201885, 0.4207903022664767, 0.4207905466871705, 0.42079078232597256, 0.4207910095986147, 0.4207912288965101, 0.42079144058844903, 0.4207916450221471, 0.42079184252567303, 0.4207920334087667, 0.42079221796405536, 0.42079239646817407, 0.4207925691828022, 0.4207927363556325, 0.4207928982212434, 0.4207930550019355, 0.420793206908486, 0.4207933541408684, 0.42079349688890494, 0.42079363533287456, 0.42079376964408877]
</pre></div>
</div>
</div>
</div>
<p>Hopefully you can see that the integral very quickly approaches one value. Surprisingly (at least to me) we don’t need many rectangles at all to accurately compute the integral of this function!</p>
</section>
<section id="id2">
<h2>Exercise<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h2>
<p>Now repeat the process for the other two integrals:</p>
<p>Make a plot of the accuracy of <span class="math notranslate nohighlight">\(\int_1^3\frac{\sin{x}}{x} dx\)</span> computed using the “rectangle rule” as described above.</p>
<p>The x-axis of the plot should be the number of rectangles used in the integral vary this between 1 rectangle and 100 rectangles. The y-axis should show the value of the integral.</p>
<p><strong>HINT</strong> All you have to do is copy the previous solution and change the function used, and the range used. You will need to write a function to compute <span class="math notranslate nohighlight">\(\frac{\sin{x}}{x}\)</span> to replace the <code class="docutils literal notranslate"><span class="pre">compute_ex2</span></code> function.</p>
<p><strong>HINT</strong> I compute this integral to be roughly 0.90257</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sinc</span><span class="p">(</span><span class="n">x_values</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x_values</span><span class="p">)</span> <span class="o">/</span> <span class="n">x_values</span>

<span class="n">integral_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">num_rectangles</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">):</span>
    <span class="n">integral_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">compute_rectangle_integral</span><span class="p">(</span><span class="n">sinc</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">num_rectangles</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">101</span><span class="p">),</span> <span class="n">integral_list</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Num rectangles&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Integral of $\sin(x) / x$ between 1 and 3&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Part_2_Numerical_integration_rectangle_rule_SOLUTIONS_24_0.png" src="../_images/Part_2_Numerical_integration_rectangle_rule_SOLUTIONS_24_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">integral_list</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.9092974268256817, 0.9043855153776189, 0.9033862496158365, 0.9030307522160774, 0.9028652282287184, 0.9027750573223239, 0.9027206003315867, 0.9026852208380283, 0.9026609489754476, 0.9026435795829132, 0.9026307239754605, 0.9026209438298128, 0.9026133311416681, 0.9026072898133084, 0.902602415401979, 0.9025984256708982, 0.902595118818477, 0.9025923474618903, 0.9025900019332169, 0.9025879992647904, 0.9025862757524618, 0.902584781827737, 0.9025834784544708, 0.9025823345532934, 0.9025813251319593, 0.9025804299088317, 0.9025796322863043, 0.902578918576032, 0.9025782774077981, 0.9025776992739187, 0.9025771761747701, 0.9025767013406085, 0.902576269011454, 0.9025758742616111, 0.9025755128587482, 0.9025751811499988, 0.902574875969298, 0.9025745945615691, 0.9025743345203145, 0.902574093736008, 0.902573870353182, 0.9025736627345743, 0.9025734694310431, 0.9025732891562112, 0.9025731207650239, 0.9025729632354961, 0.9025728156532018, 0.9025726771979454, 0.902572547132362, 0.9025724247920736, 0.9025723095771874, 0.902572200944926, 0.9025720984032277, 0.9025720015051675, 0.9025719098440743, 0.9025718230492532, 0.9025717407822371, 0.9025716627334843, 0.9025715886194579, 0.9025715181800632, 0.9025714511763202, 0.9025713873883856, 0.9025713266137164, 0.9025712686654759, 0.9025712133710683, 0.9025711605708968, 0.902571110117169, 0.9025710618728725, 0.9025710157108756, 0.9025709715130408, 0.9025709291694998, 0.9025708885779519, 0.9025708496430725, 0.902570812275902, 0.9025707763934079, 0.9025707419179673, 0.9025707087769529, 0.9025706769023812, 0.9025706462305413, 0.9025706167016724, 0.9025705882596895, 0.9025705608518823, 0.9025705344287286, 0.9025705089436082, 0.9025704843526534, 0.9025704606145181, 0.9025704376902068, 0.9025704155429491, 0.902570394138019, 0.9025703734425974, 0.9025703534256834, 0.9025703340579398, 0.9025703153115772, 0.9025702971603098, 0.9025702795792201, 0.9025702625446546, 0.9025702460342105, 0.9025702300266039, 0.9025702145016075, 0.9025701994400331]
</pre></div>
</div>
</div>
</div>
<p>Make a plot of the accuracy of <span class="math notranslate nohighlight">\(\int_1^3 \sqrt{\sin{x}} dx\)</span> computed using the “rectangle rule” as described above.</p>
<p>The x-axis of the plot should be the number of rectangles used in the integral vary this between 1 rectangle and 100 rectangles. The y-axis should show the value of the integral.</p>
<p>I computed the integral to be 1.717835 here.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">root_sin</span><span class="p">(</span><span class="n">x_values</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x_values</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">integral_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">num_rectangles</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">):</span>
    <span class="n">integral_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">compute_rectangle_integral</span><span class="p">(</span><span class="n">root_sin</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">num_rectangles</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">101</span><span class="p">),</span> <span class="n">integral_list</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Num rectangles&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Integral of $\sqrt{\sin(x)}$ between 1 and 3&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Part_2_Numerical_integration_rectangle_rule_SOLUTIONS_27_0.png" src="../_images/Part_2_Numerical_integration_rectangle_rule_SOLUTIONS_27_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">integral_list</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.9071417638190211, 1.7723565217937542, 1.7437729029117706, 1.7329954111513168, 1.727770661488054, 1.7248426176024818, 1.7230375411639167, 1.7218466581941605, 1.7210199816151037, 1.7204229203517831, 1.7199777632075626, 1.7196370867075335, 1.719370618598097, 1.7191582997051678, 1.718986412748108, 1.7188453208416572, 1.7187280937317764, 1.7186296447344398, 1.7185461723945057, 1.7184747898477504, 1.7184132730979522, 1.7183598865329102, 1.7183132597415105, 1.7182722990956907, 1.71823612332364, 1.718204015915369, 1.7181753895178602, 1.718149758989429, 1.7181267207884428, 1.7181059370506904, 1.718087123175326, 1.7180700380632599, 1.7180544763797039, 1.7180402623752742, 1.7180272449169796, 1.7180152934659012, 1.7180042948009258, 1.7179941503345941, 1.7179847739018166, 1.7179760899287055, 1.717968031908631, 1.717960541127982, 1.7179535655959823, 1.71794705914205, 1.7179409806514272, 1.717935293415304, 1.7179299645764123, 1.7179249646542096, 1.7179202671370297, 1.7179158481305128, 1.7179116860536578, 1.7179077613752525, 1.7179040563846877, 1.7179005549921107, 1.7178972425536898, 1.7178941057184627, 1.7178911322937904, 1.7178883111268595, 1.7178856320000748, 1.7178830855385634, 1.717880663128065, 1.7178783568421727, 1.7178761593774239, 1.7178740639955004, 1.717872064471519, 1.7178701550478772, 1.7178683303927191, 1.7178665855627375, 1.7178649159697463, 1.7178633173504256, 1.7178617857391631, 1.7178603174434266, 1.7178589090215548, 1.7178575572624928, 1.7178562591676247, 1.7178550119340337, 1.7178538129393859, 1.7178526597282013, 1.7178515499992437, 1.7178504815940254, 1.7178494524863517, 1.7178484607726412, 1.7178475046632373, 1.7178465824742115, 1.7178456926200598, 1.7178448336068037, 1.717844004025728, 1.71784320254767, 1.7178424279176323, 1.7178416789498685, 1.7178409545234132, 1.7178402535778188, 1.7178395751092563, 1.7178389181670255, 1.7178382818501456, 1.7178376653042287, 1.7178370677187385, 1.7178364883242145, 1.7178359263898093, 1.71783538122107]
</pre></div>
</div>
</div>
</div>
</section>
<section id="rectangle-rule-summarized">
<h2>Rectangle rule - summarized<a class="headerlink" href="#rectangle-rule-summarized" title="Permalink to this headline">#</a></h2>
<p>The rectangle rule is a simple approximation for numerically integrating a function. It can also be done on pen and paper if you want to integrate a function you have plotted …. But we live in a world with computers, so do we really want to do that in the 2020s?</p>
<p>We have shown for the example functions shown that we only need a relatively small number of rectangles to compute this, with a very low computational cost. We have demonstrated how we can show that the integral is “converging” to the right answer by plotting the integral as a function of the number of rectangles used. We will not get a different answer if we use 100000000 rectangles, the integral has already converged. However, there may be functions that require many more points than we used here … But you now know how to check if the integral is accurate enough!</p>
<p>It is possible to compute this using fewer points if we change our approximation to not use rectangles, but to use something else. Let’s explore that now.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "icg-gravwaves/M24568_M20741_CompSMAP",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./lecture_10"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="Part_2_Numerical_Integration_rectangle_rule.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">The rectangle rule</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="Part_3_Numerical_Integration_trapezium_rule.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">The Trapezium rule</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Ian Harry, Samantha Penny and Judi Thurlby<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>